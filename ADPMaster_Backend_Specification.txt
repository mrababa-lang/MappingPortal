
# ADP Master List - Backend Specification (V2)

## Overview
The ADP Master List serves as the source of truth for all vehicle metadata originating from external ERP systems. The system supports bilingual descriptions for Makes, Models, and Types, and includes a new "Kind" classification.

## Data Model (Fields)
- `adpMakeId` (String): Unique manufacturer code from source.
- `makeEnDesc` / `makeArDesc` (String): Bilingual manufacturer descriptions.
- `adpModelId` (String): Unique model code from source.
- `modelEnDesc` / `modelArDesc` (String): Bilingual model descriptions.
- `adpTypeId` (String): Unique body-style/type code from source.
- `typeEnDesc` / `typeArDesc` (String): Bilingual type descriptions.
- **NEW**: `kindCode` (String): Classification code for internal categorization.
- **NEW**: `kindEnDesc` / `kindArDesc` (String): Bilingual category descriptions.

## API Endpoints

### 1. GET /api/adp/master
- **Purpose**: Fetch paginated master records.
- **Query Params**: `page`, `size`, `q` (search term).
- **Search Logic**: Fuzzy match across `adpMakeId`, `makeEnDesc`, `adpModelId`, `modelEnDesc`, `kindEnDesc`.

### 2. POST /api/adp/master
- **Purpose**: Manual creation of a single master record.
- **Validation**: Ensure `adpMakeId` + `adpModelId` combination is unique.

### 3. PUT /api/adp/master/{id}
- **Purpose**: Update an existing record.
- **Auditing**: Generate diff entries in `adp_history`.

### 4. POST /api/adp/master/bulk
- **Purpose**: Sync with upsert logic.
- **Logic**: Match by `adpMakeId` + `adpModelId`. If exists, update all fields including new Kind fields.

## Database Schema (DDL)
- Table: `adp_master`
- Columns added: `kind_code` VARCHAR(50), `kind_en_desc` TEXT, `kind_ar_desc` TEXT.
- Index: B-Tree index on `kind_code` for optimized filtering.
